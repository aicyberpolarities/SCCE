| **Detector**                        | **Risk Statement**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | **Rationale to Enable Detector**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Public Compute Image**            | This detector identifies when a Compute Engine image is publicly accessible by checking the IAM allow policy for principals such as allUsers or allAuthenticatedUsers. Public exposure of an image increases the risk of unauthorized access, potentially leading to exploitation of vulnerabilities. It may result in inadvertent data exposure and misuse of compute resources. Early detection helps flag and remediate such configurations, thereby protecting the environment.                                                        | Enabling this detector is essential to continuously monitor and restrict public accessibility of compute images, ensuring that only authorized users have access. It helps enforce a strict security posture by identifying misconfigurations early. Proactive alerts allow for timely remediation, preventing potential exploitation. This detector also supports compliance with organizational and regulatory security policies.                                                                                                             |
| **Compute Secure Boot Disabled**    | This detector flags Shielded VMs that do not have Secure Boot enabled, a critical feature for preventing advanced threats like rootkits and bootkits. Without Secure Boot, the VM’s boot process is vulnerable to low-level malware that can compromise system integrity. The absence of this security measure increases the risk of unauthorized modifications during boot. It creates an environment where attackers can introduce persistent, hard-to-detect threats.                                        | Activating this detector ensures that all Shielded VMs adhere to best practices by enabling Secure Boot, thereby reinforcing defenses against sophisticated attacks. Early detection of non-compliant instances allows for rapid remediation to restore optimal security settings. This minimizes the attack surface and contributes to a more secure cloud infrastructure. Additionally, it supports compliance with industry-standard security frameworks.                                                                                                |
| **Compute Serial Ports Enabled**    | This detector identifies instances where serial ports are enabled, permitting connections to the instance’s serial console. Open serial ports can bypass standard authentication methods and may be exploited to gain unauthorized access. Such access might allow attackers to execute commands directly on the instance, potentially leading to data exfiltration or system compromise. This configuration increases the risk by providing an alternative access path.                                 | Enabling this detector is crucial to detect and mitigate potential unauthorized access points provided by enabled serial ports. It ensures that configurations exposing the serial console are identified promptly for remedial action. By enforcing secure access configurations, it helps maintain a tighter security perimeter. This proactive approach supports overall system integrity and the protection of sensitive workloads.                                                                                                              |
| **Confidential Computing Disabled** | This detector highlights when Confidential Computing is disabled on a Compute Engine instance, meaning that data in use is not being encrypted. Without Confidential Computing, sensitive data is vulnerable during processing, increasing the risk of leakage or unauthorized access. The absence of runtime encryption undermines the overall data security strategy. It leaves critical information exposed to potential internal and external threats during execution.                      | Enabling this detector ensures that confidential computing is in place to encrypt data during processing, adding an additional layer of protection. It allows organizations to promptly identify and remediate instances where sensitive information may be exposed. Early detection supports compliance with strict data protection standards and reduces the overall risk of data breaches. This proactive monitoring reinforces the secure handling of data throughout its lifecycle.                                                 |
| **Disk CSEK Disabled**              | This detector identifies when disks on a VM are not encrypted using Customer-Supplied Encryption Keys (CSEK). Relying solely on default encryption without CSEK may limit an organization's control over key management and increase vulnerability to unauthorized decryption. This configuration can lead to potential data breaches if the default encryption does not meet specific compliance or security needs. It reduces oversight over sensitive encryption practices. | Enabling this detector is key to ensuring that all disks use robust, customer-managed encryption to protect sensitive data. It provides immediate visibility into misconfigurations where encryption practices fall short of organizational standards. Early alerts allow for quick adjustments to encryption settings, enhancing overall data security. This measure helps maintain compliance with internal and external regulatory requirements regarding data protection.                                          |
| **Instance OS Login Disabled**      | This detector flags instances where OS Login is disabled, meaning that SSH key management is not centrally managed via IAM. Without OS Login, instances rely on less secure, metadata-based SSH key configurations that are harder to manage and monitor. This increases the risk of unauthorized access through compromised or mismanaged SSH keys. The absence of centralized control can lead to inconsistent security practices across the infrastructure.              | Enabling this detector ensures that OS Login is activated, promoting centralized and secure SSH key management. It enhances security by reducing reliance on decentralized and potentially vulnerable metadata-based key configurations. Timely detection of non-compliant instances allows for prompt corrective action to enforce best practices. This measure significantly lowers the risk of unauthorized access and helps maintain a consistent security posture across all instances.                                             |


Here is the requested information in a clear table format:

| SHA Detector                            | Risk Statements                                                                                                                                                                                                                      | Rationale to Enable Detector                                                                                                                                                                                                  |
|-----------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Public Compute Image**                | Publicly accessible Compute Engine images pose risks by potentially exposing sensitive information. Unauthorized users could access, replicate, or manipulate the VM images. Misconfigured IAM policies could result in data breaches and compliance violations. | Enabling this detector ensures that IAM policies are regularly audited for risky settings. It prevents accidental public exposure of images, thus safeguarding organizational assets and ensuring compliance with security standards. |
| **Compute Secure Boot Disabled**        | Disabling Secure Boot leaves VMs vulnerable to sophisticated threats like rootkits and bootkits. Without Secure Boot, attackers can compromise VM integrity during boot processes. This could lead to unauthorized persistence, data exfiltration, or system compromise. | Enabling this detector identifies VMs that are susceptible to boot-time attacks. Regular detection ensures integrity validation of VM boot processes, enhancing overall infrastructure security. |
| **Compute Serial Ports Enabled**        | Enabling serial ports increases the attack surface by allowing additional points of entry. Attackers might exploit serial port access to gain direct console access, bypassing standard authentication methods. Unauthorized access via serial ports could result in privilege escalation or data compromise. | Activating this detector helps identify unnecessary serial port exposure. It facilitates restricting serial access to only required systems, improving defense against unauthorized administrative access. |
| **Confidential Computing Disabled**     | Without Confidential Computing, data processed in memory remains exposed to potential threats like memory scraping or in-memory data compromise. Sensitive workloads become susceptible to advanced attacks aimed at accessing runtime data. Lack of memory encryption during processing can lead to compliance failures for sensitive data handling. | Enabling this detector helps ensure sensitive data remains encrypted throughout processing. It promotes secure runtime environments, protecting against memory-based threats and meeting strict compliance requirements. |
| **Disk CSEK Disabled**                  | Disks not encrypted with Customer-Supplied Encryption Keys (CSEK) rely solely on default encryption controls, potentially falling short of stringent security policies. Using default keys may introduce risks if those keys are compromised or mishandled. Without CSEK, organizations have reduced control over encryption key management, limiting incident response capabilities. | Activating this detector encourages robust encryption practices by prompting the use of CSEK. Enhanced control over encryption keys supports rigorous compliance mandates and effective incident response management. |
| **Instance OS Login Disabled**          | Disabling OS Login increases security risks due to decentralized SSH key management, making it difficult to track key usage or revoke access promptly. Relying on metadata-based SSH configurations increases complexity and potential misconfigurations. Without OS Login, unauthorized access and lateral movement become more feasible for attackers. | Enabling this detector supports centralized SSH key management via IAM, providing efficient and secure access control. It simplifies auditing and revocation processes, significantly enhancing overall security posture. |


1. SHA Detector Description
The AUTO_REPAIR_DISABLED detector identifies Google Kubernetes Engine (GKE) clusters where the auto-repair feature is disabled. Auto-repair is a critical maintenance feature that ensures nodes in a cluster remain in a healthy, running state by periodically checking their health status. When auto-repair is enabled, the system automatically initiates a repair process if a node fails consecutive health checks. This detector flags clusters where this important availability and security feature has been turned off, potentially leaving clusters vulnerable to prolonged outages and security issues.

2. Remediation Steps
To remediate the AUTO_REPAIR_DISABLED finding, follow these steps:

Go to the Kubernetes clusters page in the Google Cloud console.
Click the Nodes tab.
For each node pool:
Click the name of the node pool to go to its detail page.
Click Edit.
Under Management, select Enable auto-repair.
Click Save.
These changes will enable the auto-repair functionality for your GKE node pools, allowing the system to automatically detect and repair unhealthy nodes.

3. Security Risks Addressed
Disabling auto-repair in GKE clusters introduces several significant security and operational risks. When auto-repair is disabled, unhealthy nodes can remain in a failed state for extended periods, causing prolonged service disruptions and degraded cluster performance. This situation requires increased manual intervention from operations teams, diverting resources from other critical tasks. More concerning from a security perspective, compromised nodes that might have been infiltrated by malicious actors can remain active within the cluster, potentially leading to lateral movement, data exfiltration, or other security breaches. Without automatic health checks and remediation, these compromised nodes might go undetected for longer periods, expanding the attack surface and increasing the potential impact of security incidents. The combination of these factors ultimately leads to reduced service availability, increased operational costs, and a weakened overall security posture.

4. Rationale for Enabling the Detector
Enabling the AUTO_REPAIR_DISABLED detector is crucial for maintaining the availability, security, and operational efficiency of GKE clusters. This detector helps organizations proactively identify clusters where this important security control has been disabled, allowing for timely remediation. By ensuring auto-repair is enabled, organizations can significantly reduce the manual overhead associated with node maintenance and health monitoring, allowing IT teams to focus on higher-value activities. From a security perspective, auto-repair helps minimize the window of opportunity for attackers by quickly identifying and replacing potentially compromised nodes. This capability is particularly important in environments with compliance requirements around availability and security monitoring. Organizations that enable this detector and address its findings can expect improved cluster reliability, reduced operational costs through automation, and an enhanced security posture through faster detection and remediation of node-level issues. The detector serves as an important guardrail against configuration drift that might otherwise leave critical infrastructure vulnerable.

